%{!?python_sitelib: %define python_sitelib %(%{__python} -c "from distutils.sysconfig import get_python_lib; print get_python_lib()")}

Summary: A set of tools to gather troubleshooting information from a system
Name: sos
Version: @VERSION@
Release: 1%{?dist}.ovirt
Group: Applications/System
# The source for this package was pulled from upstream's vcs.  Use the
# following commands to generate the tarball:
#     git clone git://github.com/sosreport/sosreport.git
#     cd sosreport
#     git checkout @GITHASH@
#     make @SRC@
Source0: @SRC@
License: GPLv2+
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-buildroot
BuildArch: noarch
Url: http://fedorahosted.org/sos
BuildRequires: python-devel
BuildRequires: gettext
BuildRequires: python-six
Requires: libxml2-python
Requires: rpm-python
Requires: tar
Requires: bzip2
Requires: xz
Requires: python-six
Patch1: 0001-ovirt-engine-new-plugin-for-oVirt-project.patch

%description
Sos is a set of tools that gathers information about system
hardware and configuration. The information can then be used for
diagnostic purposes and debugging. Sos is commonly used to help
support technicians and developers.

%prep
%setup -q
%patch1 -p1


%build
make

%install
rm -rf ${RPM_BUILD_ROOT}
make DESTDIR=${RPM_BUILD_ROOT} install
%find_lang %{name} || echo 0

%clean
rm -rf ${RPM_BUILD_ROOT}

%files -f %{name}.lang
%defattr(-,root,root,-)
%{_sbindir}/sosreport
%{_datadir}/%{name}
%{python_sitelib}/*
%{_mandir}/man1/*
%{_mandir}/man5/*
%doc AUTHORS README.md LICENSE
%config(noreplace) %{_sysconfdir}/sos.conf

%changelog
* Thu Feb  6 2014 Sandro Bonazzola <sbonazzo@redhat.com> = 3.1-1
- New oVirt release
